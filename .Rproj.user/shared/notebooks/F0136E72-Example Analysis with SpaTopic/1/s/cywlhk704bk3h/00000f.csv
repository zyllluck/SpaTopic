"0","plot_list <- list()"
"0","for (i in seq_along(topics)){"
"0","  p <- SpatialPlot(PDAC_obj, group.by = topics[i], pt.size.factor = 8, stroke = NA) + scale_fill_manual(values = rev(pals::brewer.spectral(colors_num))) + NoAxes() + NoLegend() + coord_flip() + scale_y_reverse()"
"0","  bar_plot <- ggplot(bar_plot_data, aes(x = reorder(CellType, !!sym(topics[i]), decreasing = TRUE), y = .data[[topics[i]]])) +"
"0","    geom_bar(aes(fill = CellType), stat='identity', width = 0.7) +"
"0","    xlab('CellType') +"
"0","    scale_fill_manual(values = my_colors) +"
"0","    theme_minimal() + NoGrid() + "
"0","    theme(legend.key.size = unit(0.3, ""cm""), "
"0","          legend.position = ""none"","
"0","          axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 8))"
"0","  plot_list[[i]] <- ggdraw() + "
"0","    draw_plot(p, 0, 0.2, 1, 1, scale = 0.7) + "
"0","    draw_plot(bar_plot, 0.1, 0, 0.7, 0.5, scale = 1)"
"0","}"
