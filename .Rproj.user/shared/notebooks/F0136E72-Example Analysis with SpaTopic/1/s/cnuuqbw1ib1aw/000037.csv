"0","df.netp <- subsetCommunication(cellchat, slot.name = ""netP"")"
"0","df.netp$sTot <- paste0(df.netp$source, "" -> "", df.netp$target)"
"0","df.netp <- subset(df.netp, sTot %in% c(""CellTopic1 -> CellTopic1"",""CellTopic1 -> CellTopic2"",""CellTopic1 -> CellTopic3"",""CellTopic1 -> CellTopic4"",""CellTopic2 -> CellTopic1"",""CellTopic3 -> CellTopic1"",""CellTopic4 -> CellTopic1"",""CellTopic2 -> CellTopic4"",""CellTopic4 -> CellTopic2"",""CellTopic2 -> CellTopic2"",""CellTopic3 -> CellTopic3"",""CellTopic4 -> CellTopic4""))"
"0","df.netp$sTot <- factor(df.netp$sTot,levels = c(""CellTopic2 -> CellTopic4"",""CellTopic4 -> CellTopic2"",""CellTopic1 -> CellTopic2"",""CellTopic2 -> CellTopic1"",""CellTopic1 -> CellTopic3"",""CellTopic3 -> CellTopic1"",""CellTopic1 -> CellTopic4"",""CellTopic4 -> CellTopic1"",""CellTopic1 -> CellTopic1"",""CellTopic2 -> CellTopic2"",""CellTopic3 -> CellTopic3"",""CellTopic4 -> CellTopic4""))"
"0","df.netp <- rbind(df.netp, data.frame("
"0","    source = c(NA,NA,NA), "
"0","    target = c(NA,NA,NA), "
"0","    pathway_name = c(""VTN"",""VTN"",""VTN""), # It's just for showing the parts without communication, ""VTN"" has no particularity."
"0","    prob = c(0,0,0), "
"0","    pval = c(NA,NA,NA), "
"0","    sTot = c(""CellTopic1 -> CellTopic2"",""CellTopic2 -> CellTopic1"",""CellTopic3 -> CellTopic1"")))"
"0","library('RColorBrewer')"
"0","ggplot(df.netp, aes(x=sTot, y=pathway_name)) + "
"0","    geom_point(aes(size=pval, color=log10(prob))) + "
"0","    scale_size(range = c(4, 2), breaks = c(0.01,max(df.netp$pval[!is.na(df.netp$pval)])), labels = c(""p<0.01"",""0.01<p<0.05"")) + "
"0","    scale_colour_distiller(palette=""Spectral"", labels = c(""low"",""high""), breaks = c(log10(min(df.netp$prob[df.netp$prob!=0])),log10(max(df.netp$prob)))) +"
"0","    theme_bw() +"
"0","    theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5),"
"0","    axis.title.x = element_blank(),"
"0","    axis.title.y = element_blank()) +"
"0","    labs(size = ""p-value"", color = ""Commun.prob"")"
